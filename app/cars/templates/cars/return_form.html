{% extends "base.html" %}
{% block title %}{{ 'تسجيل العودة' if session.get('lang') == 'ar' else 'Return Car — LeavePass' }}{% endblock %}
{% block content %}
{% set ar = session.get('lang') == 'ar' %}
<div class="page-header">
  <div>
    <h1 class="page-title">{{ 'تسجيل عودة السيارة' if ar else 'Vehicle Return' }}</h1>
    <p class="page-subtitle">
      <span class="mono">{{ booking.booking_number }}</span> &nbsp;·&nbsp;
      {{ booking.car.year }} {{ booking.car.make }} {{ booking.car.model }}
      &nbsp;·&nbsp; <span class="mono">{{ booking.car.plate_number }}</span>
    </p>
  </div>
  <a href="{{ url_for('cars.dashboard') }}" class="btn btn-ghost">
    {{ '→ رجوع' if ar else '← Back' }}
  </a>
</div>

<div class="form-card" style="max-width:520px;">
  {% if booking.car.plate_image %}
  <img src="{{ booking.car.image_url() }}" alt="plate"
       style="width:100%;border-radius:6px;margin-bottom:1.5rem;object-fit:cover;max-height:140px;">
  {% endif %}

  <div class="form-card-info" style="margin-bottom:1.5rem;">
    <div class="info-row">
      <span class="info-label">{{ 'العداد عند الخروج' if ar else 'Odometer Out' }}</span>
      <span class="info-value mono">{{ booking.odometer_out }} km</span>
    </div>
    <div class="info-row">
      <span class="info-label">{{ 'الوقود عند الخروج' if ar else 'Fuel Out' }}</span>
      <span class="info-value">{{ booking.fuel_out }}%</span>
    </div>
  </div>

  <form method="POST" action="{{ url_for('cars.return_car', id=booking.id) }}">
    <div class="form-group">
      <label class="form-label">
        {{ 'قراءة العداد عند العودة (كم)' if ar else 'Odometer Reading In (km)' }}
        <span class="required">*</span>
      </label>
      <input class="form-input" type="number" name="odometer_in"
             step="0.1" min="{{ booking.odometer_out }}"
             placeholder="e.g. 45450.5" required>
    </div>
    <div class="form-group">
      <label class="form-label">
        {{ 'مستوى الوقود عند العودة (%)' if ar else 'Fuel Level In (%)' }}
        <span class="required">*</span>
      </label>
      <div class="fuel-slider-wrap">
        <input type="range" name="fuel_in" id="fuel_in"
               min="0" max="100" step="5" value="{{ booking.fuel_out or 100 }}"
               oninput="document.getElementById('fuel_in_val').textContent = this.value + '%'">
        <span class="fuel-val" id="fuel_in_val">{{ booking.fuel_out or 100 }}%</span>
      </div>
    </div>
    <div class="form-actions">
      <button type="submit" class="btn btn-primary">
        {{ 'تأكيد العودة' if ar else 'Confirm Return' }}
      </button>
    </div>
  </form>
</div>
{% endblock %}
