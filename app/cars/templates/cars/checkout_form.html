{% extends "base.html" %}
{% block title %}{{ 'تسجيل الخروج' if session.get('lang') == 'ar' else 'Check Out — Employee Applications Portal' }}{% endblock %}
{% block content %}
{% set ar = session.get('lang') == 'ar' %}
<div class="page-header">
  <div>
    <h1 class="page-title">{{ 'تسجيل خروج السيارة' if ar else 'Vehicle Check Out' }}</h1>
    <p class="page-subtitle">
      <span class="mono">{{ booking.booking_number }}</span> &nbsp;·&nbsp;
      {{ booking.car.year }} {{ booking.car.make }} {{ booking.car.model }}
      &nbsp;·&nbsp; <span class="mono">{{ booking.car.plate_number }}</span>
    </p>
  </div>
  <a href="{{ url_for('cars.dashboard') }}" class="btn btn-ghost">
    {{ '→ رجوع' if ar else '← Back' }}
  </a>
</div>

<div class="form-card" style="max-width:520px;">
  {% if booking.car.plate_image %}
  <img src="{{ booking.car.image_url() }}" alt="plate"
       style="width:100%;border-radius:6px;margin-bottom:1.5rem;object-fit:cover;max-height:140px;">
  {% endif %}

  <div class="form-card-info" style="margin-bottom:1.5rem;">
    <div class="info-row">
      <span class="info-label">{{ 'السيارة' if ar else 'Vehicle' }}</span>
      <span class="info-value">{{ booking.car.year }} {{ booking.car.make }} {{ booking.car.model }}</span>
    </div>
    <div class="info-row">
      <span class="info-label">{{ 'الوجهة' if ar else 'Destination' }}</span>
      <span class="info-value">{{ booking.destination or booking.destination_ar or '—' }}</span>
    </div>
  </div>

  <form method="POST" action="{{ url_for('cars.checkout', id=booking.id) }}">
    <div class="form-group">
      <label class="form-label">
        {{ 'قراءة العداد عند الخروج (كم)' if ar else 'Odometer Reading Out (km)' }}
        <span class="required">*</span>
      </label>
      <input class="form-input" type="number" name="odometer_out"
             step="0.1" min="0" placeholder="e.g. 45230.5" required>
    </div>
    <div class="form-group">
      <label class="form-label">
        {{ 'مستوى الوقود عند الخروج (%)' if ar else 'Fuel Level Out (%)' }}
        <span class="required">*</span>
      </label>
      <div class="fuel-slider-wrap">
        <input type="range" name="fuel_out" id="fuel_out"
               min="0" max="100" step="5" value="100"
               oninput="document.getElementById('fuel_out_val').textContent = this.value + '%'">
        <span class="fuel-val" id="fuel_out_val">100%</span>
      </div>
    </div>
    <div class="form-actions">
      <button type="submit" class="btn btn-primary">
        {{ 'تأكيد الخروج' if ar else 'Confirm Check Out' }}
      </button>
    </div>
  </form>
</div>
{% endblock %}
