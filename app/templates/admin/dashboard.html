{% extends "base.html" %}
{% block title %}{{ 'Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© â€” LeavePass' if session.get('lang') == 'ar' else 'Admin Dashboard â€” LeavePass' }}{% endblock %}
{% block content %}
{% set ar = session.get('lang') == 'ar' %}
<div class="page-header">
  <div>
    <h1 class="page-title">{{ 'Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©' if ar else 'Admin Dashboard' }}</h1>
    <p class="page-subtitle">{{ 'Ø¬Ù…ÙŠØ¹ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø© ÙÙŠ Ø§Ù„Ù…Ù†Ø¸Ù…Ø©' if ar else 'All leave requests across the organisation' }}</p>
  </div>
</div>

<div class="filter-tabs">
  {% for s, s_ar in [('all','Ø§Ù„ÙƒÙ„'),('draft','Ù…Ø³ÙˆØ¯Ø©'),('pending','Ù…Ø¹Ù„Ù‚'),('approved','Ù…Ø¹ØªÙ…Ø¯'),('archived','Ù…Ø¤Ø±Ø´Ù')] %}
  <a href="{{ url_for('main.admin_dashboard', status=s) }}"
     class="filter-tab {% if status_filter == s %}active{% endif %}">
    {{ s_ar if ar else s|capitalize }}
  </a>
  {% endfor %}
</div>

{% if records %}
<div class="table-card">
  <table class="table">
    <thead>
      <tr>
        <th>{{ 'Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨' if ar else 'Request No.' }}</th>
        <th>{{ 'Ø§Ù„Ù…ÙˆØ¸Ù' if ar else 'Employee' }}</th>
        <th>{{ 'Ø§Ù„Ù‚Ø³Ù…' if ar else 'Dept.' }}</th>
        <th>{{ 'Ø§Ù„ÙˆØ¬Ù‡Ø©' if ar else 'Destination' }}</th>
        <th>{{ 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©' if ar else 'Departure' }}</th>
        <th>{{ 'Ø§Ù„Ù…Ø¯ÙŠØ±' if ar else 'Manager' }}</th>
        <th>{{ 'Ø§Ù„Ø­Ø§Ù„Ø©' if ar else 'Status' }}</th>
        <th>{{ 'Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª' if ar else 'Actions' }}</th>
      </tr>
    </thead>
    <tbody>
    {% for r in records %}
    <tr>
      <td><span class="mono">{{ r.request_number }}</span></td>
      <td>{{ r.employee_name_ar if ar and r.employee_name_ar else r.employee_name }}</td>
      <td>{{ r.employee_department_ar if ar and r.employee_department_ar else r.employee_department }}</td>
      <td>{{ (r.destination_ar if ar and r.destination_ar else r.destination) or 'â€”' }}</td>
      <td>{{ r.departure_datetime.strftime('%Y/%m/%d %I:%M %p') if ar else r.departure_datetime.strftime('%b %d %Y, %I:%M %p') }}</td>
      <td>{{ r.manager_name_ar if ar and r.manager_name_ar else r.manager_name }}</td>
      <td><span class="badge {{ r.status_badge_class() }}">{{ r.status }}</span></td>
      <td class="actions-cell">
        <a href="{{ url_for('main.print_slip', id=r.id) }}" class="btn btn-sm btn-outline">ğŸ–¨</a>
        <a href="{{ url_for('main.admin_view', id=r.id) }}" class="btn btn-sm btn-ghost">
          {{ 'Ø¹Ø±Ø¶' if ar else 'View' }}
        </a>
      </td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
<div class="empty-state">
  <div class="empty-icon">ğŸ“­</div>
  <h3>{{ 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª' if ar else 'No records found' }}</h3>
  <p>{{ 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª ØªØ·Ø§Ø¨Ù‚ Ø§Ù„ÙÙ„ØªØ± Ø§Ù„Ù…Ø­Ø¯Ø¯.' if ar else 'No leave requests match the selected filter.' }}</p>
</div>
{% endif %}
{% endblock %}
