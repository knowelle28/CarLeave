{% extends "base.html" %}
{% block title %}{{ lr.request_number }} â€” LeavePass{% endblock %}
{% block content %}
{% set ar = session.get('lang') == 'ar' %}
<div class="page-header">
  <div>
    <h1 class="page-title">{{ lr.request_number }}</h1>
    <p class="page-subtitle">
      <span class="badge {{ lr.status_badge_class() }}">{{ lr.status }}</span>
      &nbsp;Â·&nbsp;
      {{ 'ØªÙ… Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… ÙÙŠ' if ar else 'Submitted' }}
      {{ lr.created_at.strftime('%Y/%m/%d') if ar else lr.created_at.strftime('%B %d, %Y') }}
    </p>
  </div>
  <div style="display:flex;gap:0.75rem;">
    <a href="{{ url_for('main.print_slip', id=lr.id) }}" class="btn btn-outline">
      ğŸ–¨ {{ 'Ø·Ø¨Ø§Ø¹Ø©' if ar else 'Print' }}
    </a>
    <a href="{{ url_for('main.admin_dashboard') }}" class="btn btn-ghost">
      {{ 'â†’ Ø±Ø¬ÙˆØ¹' if ar else 'â† Back' }}
    </a>
  </div>
</div>

<div class="detail-grid">
  <div class="detail-card">
    <h3 class="detail-card-title">{{ 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù' if ar else 'Employee Details' }}</h3>
    <div class="detail-rows">
      <div class="detail-row">
        <span>{{ 'Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„' if ar else 'Full Name' }}</span>
        <span>{{ lr.employee_name_ar if ar and lr.employee_name_ar else lr.employee_name }}</span>
      </div>
      <div class="detail-row">
        <span>{{ 'Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¸Ù' if ar else 'Employee No.' }}</span>
        <span class="mono">{{ lr.employee_number }}</span>
      </div>
      <div class="detail-row">
        <span>{{ 'Ø§Ù„Ù‚Ø³Ù…' if ar else 'Department' }}</span>
        <span>{{ lr.employee_department_ar if ar and lr.employee_department_ar else lr.employee_department }}</span>
      </div>
    </div>
  </div>

  <div class="detail-card">
    <h3 class="detail-card-title">{{ 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©' if ar else 'Leave Details' }}</h3>
    <div class="detail-rows">
      <div class="detail-row">
        <span>{{ 'Ø§Ù„ÙˆØ¬Ù‡Ø©' if ar else 'Destination' }}</span>
        <span>{{ (lr.destination_ar if ar and lr.destination_ar else lr.destination) or 'â€”' }}</span>
      </div>
      <div class="detail-row">
        <span>{{ 'Ø§Ù„Ø³Ø¨Ø¨' if ar else 'Reason' }}</span>
        <span>{{ lr.reason_ar if ar and lr.reason_ar else lr.reason }}</span>
      </div>
      <div class="detail-row">
        <span>{{ 'Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©' if ar else 'Departure' }}</span>
        <span>{{ lr.departure_datetime.strftime('%Y/%m/%d %I:%M %p') if ar else lr.departure_datetime.strftime('%B %d, %Y %I:%M %p') }}</span>
      </div>
      <div class="detail-row">
        <span>{{ 'Ø§Ù„Ø¹ÙˆØ¯Ø©' if ar else 'Return' }}</span>
        <span>{{ lr.return_datetime.strftime('%Y/%m/%d %I:%M %p') if ar else lr.return_datetime.strftime('%B %d, %Y %I:%M %p') }}</span>
      </div>
      <div class="detail-row">
        <span>{{ 'Ø§Ù„Ù…Ø¯ÙŠØ±' if ar else 'Manager' }}</span>
        <span>{{ lr.manager_name_ar if ar and lr.manager_name_ar else lr.manager_name }}</span>
      </div>
    </div>
  </div>

  <div class="detail-card">
    <h3 class="detail-card-title">{{ 'Ø³Ø¬Ù„ Ø§Ù„ÙˆÙ‚Øª' if ar else 'Record Timeline' }}</h3>
    <div class="detail-rows">
      <div class="detail-row">
        <span>{{ 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡' if ar else 'Created' }}</span>
        <span>{{ lr.created_at.strftime('%Y/%m/%d %I:%M %p') if ar else lr.created_at.strftime('%b %d, %Y %I:%M %p') }}</span>
      </div>
      <div class="detail-row">
        <span>{{ 'Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«' if ar else 'Last Updated' }}</span>
        <span>{{ lr.updated_at.strftime('%Y/%m/%d %I:%M %p') if ar else lr.updated_at.strftime('%b %d, %Y %I:%M %p') }}</span>
      </div>
      <div class="detail-row">
        <span>{{ 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©' if ar else 'Printed' }}</span>
        <span>{{ lr.printed_at.strftime('%Y/%m/%d %I:%M %p') if lr.printed_at else 'â€”' }}</span>
      </div>
    </div>
  </div>

  <div class="detail-card">
    <h3 class="detail-card-title">{{ 'ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©' if ar else 'Update Status' }}</h3>
    <p style="font-size:0.85rem;color:var(--text-muted);margin-bottom:1rem;">
      {{ 'Ø¨Ø¹Ø¯ Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ© Ø§Ù„Ù…ÙˆÙ‚Ø¹Ø©ØŒ Ø­Ø¯Ù‘Ø« Ø§Ù„Ø­Ø§Ù„Ø© Ø¥Ù„Ù‰ Ù…Ø¹ØªÙ…Ø¯.' if ar else 'Once HR receives the signed administrative copy, mark it as approved.' }}
    </p>
    <form method="POST" action="{{ url_for('main.update_status', id=lr.id) }}">
      <div class="status-btn-group">
        {% for s, s_ar in [('draft','Ù…Ø³ÙˆØ¯Ø©'),('pending','Ù…Ø¹Ù„Ù‚'),('approved','Ù…Ø¹ØªÙ…Ø¯'),('archived','Ù…Ø¤Ø±Ø´Ù')] %}
        <button type="submit" name="status" value="{{ s }}"
          class="btn btn-sm {% if lr.status == s %}btn-primary{% else %}btn-outline{% endif %}">
          {{ s_ar if ar else s|capitalize }}
        </button>
        {% endfor %}
      </div>
    </form>
  </div>
</div>
{% endblock %}
