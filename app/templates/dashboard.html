{% extends "base.html" %}
{% block title %}{{ 'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… â€” LeavePass' if session.get('lang') == 'ar' else 'Dashboard â€” LeavePass' }}{% endblock %}
{% block content %}
{% set ar = session.get('lang') == 'ar' %}
<div class="page-header">
  <div>
    <h1 class="page-title">{{ 'Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©' if ar else 'My Leave Requests' }}</h1>
    <p class="page-subtitle">{{ 'ØªØªØ¨Ø¹ ÙˆØ¥Ø¯Ø§Ø±Ø© ØªØµØ§Ø±ÙŠØ­ Ù…ØºØ§Ø¯Ø±Ø© Ø§Ù„Ù…ÙƒØªØ¨' if ar else 'Track and manage your office leave passes' }}</p>
  </div>
  <a href="{{ url_for('main.new_leave') }}" class="btn btn-primary">
    {{ '+ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯' if ar else '+ New Request' }}
  </a>
</div>

{% if records %}
<div class="table-card">
  <table class="table">
    <thead>
      <tr>
        <th>{{ 'Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨' if ar else 'Request No.' }}</th>
        <th>{{ 'Ø§Ù„ÙˆØ¬Ù‡Ø©' if ar else 'Destination' }}</th>
        <th>{{ 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©' if ar else 'Departure' }}</th>
        <th>{{ 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹ÙˆØ¯Ø©' if ar else 'Return' }}</th>
        <th>{{ 'Ø§Ù„Ù…Ø¯ÙŠØ±' if ar else 'Manager' }}</th>
        <th>{{ 'Ø§Ù„Ø­Ø§Ù„Ø©' if ar else 'Status' }}</th>
        <th>{{ 'Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª' if ar else 'Actions' }}</th>
      </tr>
    </thead>
    <tbody>
    {% for r in records %}
    <tr>
      <td><span class="mono">{{ r.request_number }}</span></td>
      <td>{{ (r.destination_ar if ar and r.destination_ar else r.destination) or 'â€”' }}</td>
      <td>{{ r.departure_datetime.strftime('%Y/%m/%d %I:%M %p') if ar else r.departure_datetime.strftime('%b %d, %Y %I:%M %p') }}</td>
      <td>{{ r.return_datetime.strftime('%Y/%m/%d %I:%M %p') if ar else r.return_datetime.strftime('%b %d, %Y %I:%M %p') }}</td>
      <td>{{ (r.manager_name_ar if ar and r.manager_name_ar else r.manager_name) }}</td>
      <td><span class="badge {{ r.status_badge_class() }}">{{ r.status }}</span></td>
      <td class="actions-cell">
        <a href="{{ url_for('main.print_slip', id=r.id) }}" class="btn btn-sm btn-outline">
          ğŸ–¨ {{ 'Ø·Ø¨Ø§Ø¹Ø©' if ar else 'Print' }}
        </a>
        {% if r.is_editable() %}
        <a href="{{ url_for('main.edit_leave', id=r.id) }}" class="btn btn-sm btn-ghost">
          âœ {{ 'ØªØ¹Ø¯ÙŠÙ„' if ar else 'Edit' }}
        </a>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
<div class="empty-state">
  <div class="empty-icon">ğŸ“‹</div>
  <h3>{{ 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯' if ar else 'No leave requests yet' }}</h3>
  <p>{{ 'Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ù…ØºØ§Ø¯Ø±Ø© Ø§Ù„Ù…ÙƒØªØ¨ØŒ Ø£Ù†Ø´Ø¦ ØªØµØ±ÙŠØ­ Ù…ØºØ§Ø¯Ø±Ø© Ù‡Ù†Ø§.' if ar else 'When you need to leave the office, create a leave pass here.' }}</p>
  <a href="{{ url_for('main.new_leave') }}" class="btn btn-primary">
    {{ 'Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙˆÙ„ Ø·Ù„Ø¨' if ar else 'Create your first request' }}
  </a>
</div>
{% endif %}
{% endblock %}
